{"version":3,"sources":["../es6/localhost.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAM,yiBAAN;;AAoBA,IAAM,+XAAN;;AAeA,IAAM,kBAAkB,qBAAlB;AACN,SAAS,mBAAT,CAA6B,GAA7B,EAAkC;AAChC,SAAO,CAAC,gBAAgB,IAAhB,CAAqB,GAArB,CAAD,CADyB;CAAlC;;AAIA,SAAS,OAAT,CAAiB,SAAjB,EAA4B;AAC1B,MAAI,yBAAyB,0EAAzB,CADsB;AAE1B,MAAI,iBAAiB,oBAAoB,WAApB,GACjB,WADiB,yBAEZ,UAAU,QAAV,CAFY,CAFK;;uBAMP,sBAAc;AAC/B,cAAU,EAAV;GADiB,EAEhB,SAFgB,EANO;;MAMpB,mCANoB;;;AAU1B,MAAI,oBAAoB,WAApB,IAAmC,mBAAmB,WAAnB,EAAgC;AACrE,YAAQ,IAAR,CAAa,IAAb,EADqE;GAAvE,MAEO,IAAI,OAAO,SAAP,CAAiB,QAAjB,CAA0B,IAA1B,CAA+B,QAA/B,MAA6C,iBAA7C,EAAgE;AACzE,YAAQ,IAAR,CAAa,+BAAb,EADyE;AAEzE,eAAW,EAAX,CAFyE;GAApE;;uCAZmB;;;;;AAiB1B,oDAA8B,uBAAe,QAAf,SAA9B,oGAAwD;;;UAA9C,sBAA8C;UAAxC,2BAAwC;;AACtD,UAAI,oBAAoB,IAApB,CAAJ,EAA+B;AAC7B,gBAAQ,KAAR,kCAEqB,uCACD,yBAHpB,EAD6B;AAQ7B,eAAO,SAAS,IAAT,CAAP,CAR6B;OAA/B;;AAWA,UAAI,oBAAoB,SAApB,CAAJ,EAAoC;AAClC,gBAAQ,KAAR,+BAEkB,+BAA0B,qCAC1B,0DAHlB,EADkC;AAOlC,eAAO,SAAS,IAAT,CAAP,CAPkC;OAApC;KAZF;;;;;;;;;;;;;;GAjB0B;;AAwC1B,SAAO;AACL,0CAAwB;AACtB,UAAI,UAAO,MAAP,GAAgB,CAAhB,IAAqB,UAAO,MAAP,KAAkB,CAAlB,EAAqB;AAC5C,gBAAQ,KAAR,CAAc,yGAAd,EAD4C;;AAG5C,eAAO,SAAP,CAH4C;OAA9C;;;AADsB,UAQlB,kCAAqB,UAAO,MAAP,GAAgB,CAAhB,uCAAO,MAAP,GAAgB,CAAhB,KAArB,CARkB;AAStB,UAAI,YAAY,SAAS,WAAT,CAAZ,CATkB;;AAWtB,aAAO,OAAO,SAAP,KAAqB,WAArB,GACH,SADG,GAEH,SAFG,CAXe;KADnB;GAAP,CAxC0B;CAA5B;;AA2DA,OAAO,OAAP,GAAiB,OAAO,OAAP,GAAiB,OAAjB","file":"localhost.js","sourcesContent":["'use strict';\n\nconst help = `\nLooks you are not providing a valid set of settings! Let me show you a little snippet:\n\nvar localhost = {\n    features: {\n        my_cool_feature_name: 'version_a',\n        another_feature_name: 'version_b',\n        ...\n    }\n};\n\nvar sdk = splitio(localhost);\n\nsdk.getTreatment('my_cool_feature_name') === 'version_a'; // This is true!\nsdk.getTreatment('another_feature_name') === 'version_b'; // This is true!\nsdk.getTreatment('missing_feature_name') === 'control';   // This is true!\n\nLet's start hacking!\n`;\n\nconst featuresAttributeMustBeAnObject = `\nHey! Please recheck features attribute, it should be an object with the\nfollowing shape:\n\nvar localhost = {\n  ===> features: {\n  ===>     my_cool_feature_name: 'version_a',\n  ===>     another_feature_name: 'version_b',\n  ===>     ...\n  ===> }\n};\n\nREMEMBER: any feature not present in this object will be evaluated as 'control'\n`;\n\nconst validIdentifier = /^[a-z][-_a-z0-9]*$/i;\nfunction isIdentifierInvalid(str) {\n  return !validIdentifier.test(str);\n}\n\nfunction splitio(localhost) {\n  let typeOfLocalhost = typeof localhost;\n  let typeOfFeatures = typeOfLocalhost === 'undefined'\n    ? 'undefined' :\n    typeof localhost.features;\n\n  let { features } = Object.assign({\n    features: {}\n  }, localhost);\n\n  if (typeOfLocalhost === 'undefined' || typeOfFeatures === 'undefined') {\n    console.info(help);\n  } else if (Object.prototype.toString.call(features) !== '[object Object]') {\n    console.info(featuresAttributeMustBeAnObject);\n    features = {};\n  }\n\n  for (let [name, treatment] of Object.entries(features)) {\n    if (isIdentifierInvalid(name)) {\n      console.error(\n`>\n>> Invalid feature name \"${name}\"\n>>>> Please check using ${validIdentifier}\n>\n`\n      );\n      delete features[name];\n    }\n\n    if (isIdentifierInvalid(treatment)) {\n      console.error(\n`>\n>> Invalid treatment \"${treatment}\" in feature \"${name}\"\n>> Please check using ${validIdentifier} and 'control' is a reserved word\n>`\n      );\n      delete features[name];\n    }\n  }\n\n  return {\n    getTreatment(...params) {\n      if (params.length > 2 || params.length === 0) {\n        console.error('Please verify the parameters, you could use getTreatment(featureName) or getTreatment(key, featureName)');\n\n        return 'control';\n      }\n\n      // always the latest parameter is the feature name.\n      let featureName = params[params.length - 1];\n      let treatment = features[featureName];\n\n      return typeof treatment === 'undefined' ?\n          'control' :\n          treatment;\n    }\n  };\n}\n\nglobal.splitio = module.exports = splitio;\n"]}