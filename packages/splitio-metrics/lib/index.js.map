{"version":3,"sources":["../es6/index.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,SAAS,QAAQ,WAAR,CAAT;AACJ,IAAI,UAAU,QAAQ,YAAR,CAAV;AACJ,IAAI,eAAe,QAAQ,iBAAR,CAAf;AACJ,IAAI,qBAAqB,QAAQ,uBAAR,CAArB;;;AAGJ,IAAI,gBAAgB,QAAQ,qCAAR,CAAhB;;AAEJ,SAAS,aAAT,CAAuB,IAAvB,EAA6B,gBAA7B,EAA+C,cAA/C,EAA+D;AAC7D,MAAI,IAAI,kBAAJ,CADyD;AAE7D,MAAI,IAAI,eAAe,CAAf,CAAJ,CAFyD;;AAI7D,SAAO;AACL,gCAAU;AACR,aAAO,CAAP,CADQ;KADL;AAKL,gCAAU;AACR,aAAO,CAAC,EAAE,OAAF,EAAD,IAAgB,OAAO;AAC5B,0BAAkB,cAAc,GAAd,CAAkB,kBAAlB,CAAlB;AACA,aAAK,QAAQ,kBAAR,EAA4B,CAA5B,CAAL;OAFqB,EAItB,IAJsB,CAIjB,UAAS,IAAT,EAAe;AAAE,UAAE,KAAF,GAAF,OAAoB,IAAP,CAAb;OAAf,CAJiB,CAKtB,KALsB,CAKhB,UAAS,KAAT,EAAgB;AAAE,UAAE,KAAF,GAAF;OAAhB,CALA,CADC;KALL;GAAP,CAJ6D;CAA/D;;AAoBA,IAAI,MAAM,cAAc,kBAAd,EAAkC,kBAAlC,EAAsD,YAAtD,CAAN;;AAEJ,SAAS,OAAT,GAAmB;AACjB,MAAI,OAAJ,GADiB;CAAnB;;AAIA,OAAO,OAAP,GAAiB;AACf,UADe;AAEf,kBAFe;CAAjB","file":"index.js","sourcesContent":["'use strict';\n\nlet TimeDS = require('./ds/Time');\nlet TimeDTO = require('./dto/Time');\nlet TimerFactory = require('./tracker/Timer');\nlet FibonacciCollector = require('./collector/Fibonacci');\n\n// @TODO fixes comming soon\nlet splitSettings = require('@splitsoftware/splitio/lib/settings');\n\nfunction metricFactory(name, CollectorFactory, TrackerFactory) {\n  let c = CollectorFactory();\n  let t = TrackerFactory(c);\n\n  return {\n    tracker() {\n      return t;\n    },\n\n    publish() {\n      return !c.isEmpty() && timeDS({\n        authorizationKey: splitSettings.get('authorizationKey'),\n        dto: timeDTO('sdk.getTreatment', c)\n      })\n      .then(function(resp) { c.clear(); return resp; })\n      .catch(function(error) { c.clear(); });\n    }\n  };\n}\n\nlet sdk = metricFactory('sdk.getTreatment', FibonacciCollector, TimerFactory);\n\nfunction publish() {\n  sdk.publish();\n}\n\nmodule.exports = {\n  sdk,\n  publish\n};\n"]}